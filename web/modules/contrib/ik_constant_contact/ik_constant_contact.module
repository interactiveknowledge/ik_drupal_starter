<?php

/**
 * @file
 * Contains ik_constant_contact.module.
 */

use Drupal\Core\Routing\RouteMatchInterface;

/**
 * Implements hook_cron().
 */
function ik_constant_contact_cron() {
  $cc = \Drupal::service('ik_constant_contact');

  $cc->refreshToken();
  $cc->getContactLists();
}

/**
 * Implements hook_help().
 */
function ik_constant_contact_help($route_name, RouteMatchInterface $arg) {
  switch ($route_name) {
    case 'help.page.ik_constant_contact':
      $output = '';
      $output .= '<h3>' . t('Introduction') . '</h3>';
      $output .= '<p>' . t('Constant Contact integration module using <a href=":link">API v3</a>.', [':link' => 'https://v3.developer.constantcontact.com/']) . t('It allows users to add an API key and secret generated by a
      Constant Contact account in the settings.php
      file (or via an admin UI). Then will allow users
      to activate/enable a list and create a block
      derivative for each list that is enabled.
      It also provides an optional REST endpoint
      to send signups to the CC API for enabled lists. For a full description of the module, visit the
      <a href=":link">project page</a>. ', [':link' => 'https://www.drupal.org/project/ik_constant_contact']) . t('To submit bug reports and feature suggestions, or track changes
      visit the <a href=":link">project issue page</a>.', [':link' => 'https://www.drupal.org/project/issues/ik_constant_contact']) . '</p>';

      $output .= '<h3>' . t('Configuration') . '</h3>';
      $output .= '<p>' . t('<a href=":link">How to install and configure the module</a>', [':link' => 'https://interactiveknowledge.com/insights/how-use-drupal-constant-contact-module']) . '.</p>';

      $output .= '<br/><br/>';

      return $output;
  }
}
